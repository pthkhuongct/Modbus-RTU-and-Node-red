module.exports=function(i){require("source-map-support").install();var r=require("./core/modbus-io-core");i.nodes.registerType("modbus-io-config",function(e){var t=require("fs-extra"),a=(i.nodes.createNode(this,e),this.name=e.name,this.path=e.path,this.format=e.format,this.addressOffset=e.addressOffset,this);function n(){a.lineReader.removeAllListeners(),a.lineReader.on("error",function(e){r.internalDebug(e.message)}),a.lineReader.on("line",function(e){e&&a.configData.push(e)}),a.lineReader.on("end",function(){a.lastUpdatedAt=Date.now(),r.internalDebug("Read IO Done From File "+a.path),a.warn({payload:r.allValueNamesFromIOFile(a),name:"Modbus Value Names From IO File",path:a.path}),a.emit("updatedConfig",a.configData)}),r.internalDebug("Loading IO File Started For "+a.path)}a.setMaxListeners(0),a.lastUpdatedAt=null,t.existsSync(a.path)?(a.lineReader=new r.LineByLineReader(a.path),r.internalDebug("Read IO File "+a.path),a.configData=[],n(),a.watcher=t.watchFile(a.path,function(e,t){r.internalDebug("the current mtime is: ".concat(e.mtime)),r.internalDebug("the previous mtime was: ".concat(t.mtime)),e.mtime!==t.mtime&&(r.internalDebug("Reload IO File "+a.path),a.configData=[],delete a.lastUpdatedAt,a.lineReader.removeAllListeners(),a.lineReader=new r.LineByLineReader(a.path),n(),r.internalDebug("Reloading IO File Started For "+a.path))}),a.on("close",function(e){t.unwatchFile(a.path),a.watcher.stop(),a.lineReader.removeAllListeners(),a.removeAllListeners(),e()})):(r.internalDebug("IO File Not Found "+a.path),a.warn("Modbus IO File Not Found "+a.path))})};
//# sourceMappingURL=maps/modbus-io-config.js.map
